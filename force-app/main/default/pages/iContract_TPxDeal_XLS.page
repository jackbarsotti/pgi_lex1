<apex:page id="pg" showHeader="false" applyBodyTag="false" standardController="CONMAN_Contract__c" applyHtmlTag="false" standardStylesheets="false"
    contentType="application/vnd.ms-excel#contract.xml" extensions="iContract_NA_Master_Controller" >
    {!xmlheader}
    <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel"
        xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:html="http://www.w3.org/TR/REC-html40">

        <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">

            <Author></Author>

            <LastAuthor></LastAuthor>

            <Company></Company>

            <Version>16.00</Version>

        </DocumentProperties>
        <OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office">
            <AllowPNG/>
        </OfficeDocumentSettings>
        <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">
            <WindowHeight>32767</WindowHeight>
            <WindowWidth>32767</WindowWidth>
            <WindowTopX>800</WindowTopX>
            <WindowTopY>460</WindowTopY>
            <ProtectStructure>False</ProtectStructure>
            <ProtectWindows>False</ProtectWindows>
        </ExcelWorkbook>
        <Styles>
            <Style ss:ID="Default" ss:Name="Normal">
                <Alignment ss:Vertical="Bottom"/><Borders/><Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11" ss:Color="#000000"/><Interior/><NumberFormat/><Protection/>
            </Style>
            <Style ss:ID="s16" ss:Name="Currency">
            </Style>
            <Style ss:ID="s17">
                <Alignment ss:Horizontal="Left" ss:Vertical="Bottom"/><Borders><Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/></Borders><Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11" ss:Color="#A6A6A6"/><NumberFormat ss:Format="0"/>
            </Style>
            <Style ss:ID="s18" ss:Parent="s16">
                <Alignment ss:Horizontal="Left" ss:Vertical="Bottom"/><Borders><Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/></Borders><Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11" ss:Color="#A6A6A6"/>
            </Style>
            <Style ss:ID="s19">
                <Alignment ss:Horizontal="Left" ss:Vertical="Bottom"/><Borders><Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/></Borders><Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11" ss:Color="#000000" ss:Bold="1" ss:Underline="Single"/><Interior ss:Color="#D9D9D9" ss:Pattern="Solid"/>
            </Style>
            <Style ss:ID="s20">
                <Borders><Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/></Borders><Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11" ss:Color="#000000" ss:Bold="1" ss:Underline="Single"/><Interior ss:Color="#D9D9D9" ss:Pattern="Solid"/>
            </Style>
            <Style ss:ID="s21">
                <Alignment ss:Horizontal="Center" ss:Vertical="Bottom"/><Interior/>
            </Style>
            <Style ss:ID="s22">
                <Interior/>
            </Style>
            <Style ss:ID="s30">
                <Alignment ss:Horizontal="Left" ss:Vertical="Bottom"/><Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11" ss:Color="#A6A6A6"/>
            </Style>
            <Style ss:ID="s31">
                <Alignment ss:Horizontal="Center" ss:Vertical="Bottom" ss:WrapText="1"/><Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11" ss:Color="#000000" ss:Bold="1"/><Interior ss:Color="#D9D9D9" ss:Pattern="Solid"/>
            </Style>
            <Style ss:ID="s32">
                <Alignment ss:Horizontal="Center" ss:Vertical="Bottom"/><Interior ss:Color="#D9D9D9" ss:Pattern="Solid"/>
            </Style>
            <Style ss:ID="s33">
                <Alignment ss:Horizontal="Left" ss:Vertical="Bottom" /><Borders><Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" /><Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" /><Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1" /><Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" /></Borders><Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11" ss:Color="#A6A6A6" />
            </Style>
            <Style ss:ID="s35">
                <Alignment ss:Horizontal="Left" ss:Vertical="Bottom"/><Interior ss:Color="#D9D9D9" ss:Pattern="Solid"/>
            </Style>
        </Styles>

        <Worksheet ss:Name="Deal Reg Details">

            <Table ss:ExpandedColumnCount="6" x:FullColumns="1" x:FullRows="1" ss:DefaultColumnWidth="53" ss:DefaultRowHeight="15">
                <Column ss:Width="94" />
                <Column ss:AutoFitWidth="0" ss:Width="70" />
                <Column ss:AutoFitWidth="0" ss:Width="75" />
                <Column ss:Index="6" ss:AutoFitWidth="0" ss:Width="127" />
                <Row>
                    <Cell>
                        <Data ss:Type="String">Company Name:</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!agreementAccountName}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">Street Address 1</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">Street Address 2</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">City</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!contract.Account_Name__r.BillingCity}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">State</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!contract.Account_Name__r.BillingState}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">Country</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!contract.Account_Name__r.BillingCountry}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">Zip</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!contract.Account_Name__r.BillingPostalCode}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">Billing Email</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!oppData.Billing_Email__c}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell ss:MergeAcross="5" ss:StyleID="s31">
                        <Data ss:Type="String">Contact Data</Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">Full Name</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!oppData.Primary_Contact__r.Name}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">Title</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!oppData.Primary_Contact_Title__c}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">Email</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!oppData.Primary_Contact_Email_Address__c}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">Phone</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!oppData.Primary_Contact_Phone__c}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell ss:MergeAcross="5" ss:StyleID="s31">
                        <Data ss:Type="String">PGi Sales Rep Data</Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">Full Name</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!opportunityOwner.Name}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">Email</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!opportunityOwner.Email}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">Phone</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!opportunityOwner.Phone}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell ss:MergeAcross="5" ss:StyleID="s31">
                        <Data ss:Type="String">Deal Data</Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">Term Length</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!contract.Contracted_Term__c}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">PGi SF Oppty #</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!oppData.Opportunity_Number__c}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">PGi Contract #</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!contract.Name}" escape="false" /></Data>
                    </Cell>
                </Row>
                <Row>
                    <Cell>
                        <Data ss:Type="String">TPx Rep</Data>
                    </Cell>
                    <Cell ss:MergeAcross="4" ss:StyleID="s30">
                        <Data ss:Type="String"><apex:outputText value="{!oppData.TPx_Rep__c}" escape="false" /></Data>
                    </Cell>
                </Row>
            </Table>
            <WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">
                <PageSetup>
                    <Header x:Margin="0.3" />
                    <Footer x:Margin="0.3" />
                    <PageMargins x:Bottom="0.75" x:Left="0.7" x:Right="0.7" x:Top="0.75" />
                </PageSetup>
                <Print>
                    <ValidPrinterInfo/>
                    <HorizontalResolution>300</HorizontalResolution>
                    <VerticalResolution>300</VerticalResolution>
                </Print>
                <Selected/>
                <Panes>
                    <Pane>
                        <Number>3</Number>
                        <ActiveRow>1</ActiveRow>
                        <ActiveCol>1</ActiveCol>
                        <RangeSelection>R2C2:R2C6</RangeSelection>
                    </Pane>
                </Panes>
                <ProtectObjects>False</ProtectObjects>
                <ProtectScenarios>False</ProtectScenarios>
            </WorksheetOptions>
        </Worksheet>

        <Worksheet ss:Name="Product Details">

            <Table ss:ExpandedColumnCount="11" x:FullColumns="1" x:FullRows="1" ss:DefaultColumnWidth="53" ss:DefaultRowHeight="15">
                <Column ss:Index="4" ss:AutoFitWidth="0" ss:Width="101" />
                <Column ss:AutoFitWidth="0" ss:Width="94" />
                <Column ss:AutoFitWidth="0" ss:Width="133" />
                <Column ss:AutoFitWidth="0" ss:Width="117" />
                <Row>
                    <Cell ss:MergeAcross="10" ss:StyleID="s32">
                        <Data ss:Type="String">Product Data</Data>
                    </Cell>
                </Row>
                <Row ss:StyleID="s22">
                    <Cell ss:StyleID="s21" />
                    <Cell ss:StyleID="s21" />
                    <Cell ss:StyleID="s21" />
                    <Cell ss:StyleID="s21" />
                    <Cell ss:StyleID="s21" />
                    <Cell ss:StyleID="s21" />
                    <Cell ss:StyleID="s21" />
                </Row>
                <Row>
                    <Cell ss:Index="3" ss:StyleID="s19">
                        <Data ss:Type="String">Quantity</Data>
                    </Cell>
                    <Cell ss:MergeAcross="3" ss:StyleID="s19">
                        <Data ss:Type="String">Item</Data>
                    </Cell>
                    <Cell ss:StyleID="s20">
                        <Data ss:Type="String">Cost</Data>
                    </Cell>
                </Row>

                <apex:repeat value="{!licenseData}" var="ld">
                    <Row>
                        <Cell ss:Index="2" ss:MergeAcross="6" ss:StyleID="s35">
                            <Data ss:Type="String"><apex:outputText value="{!ld.name}" escape="false" /></Data>
                        </Cell>
                    </Row>
                    <apex:repeat value="{!ld.subscriptions}" var="sub">
                        <Row>
                            <Cell ss:Index="3" ss:StyleID="s17">
                                <Data ss:Type="Number"><apex:outputText value="{!sub.quantity}" escape="false" /></Data>
                            </Cell>
                            <Cell ss:MergeAcross="3" ss:StyleID="s33">
                                <Data ss:Type="String"><apex:outputText value="{!sub.name}" escape="false" /></Data>
                            </Cell>
                            <Cell ss:StyleID="s18">
                                <Data ss:Type="String"><apex:outputText value="{!sub.tsf}" escape="false" /></Data>
                            </Cell>
                        </Row>
                    </apex:repeat>
                    <apex:repeat value="{!ld.bundleDetails}" var="bndl">
                        <Row>
                            <Cell ss:Index="3" ss:StyleID="s17">
                                <Data ss:Type="Number"><apex:outputText value="{!bndl.quantity}" escape="false" /></Data>
                            </Cell>
                            <Cell ss:MergeAcross="3" ss:StyleID="s33">
                                <Data ss:Type="String"><apex:outputText value="{!bndl.name}" escape="false" /></Data>
                            </Cell>
                            <Cell ss:StyleID="s18">

                                <Data ss:Type="String"><apex:outputText value="{!bndl.tsf}" escape="false" /></Data>
                            </Cell>
                        </Row>
                    </apex:repeat>
                    <apex:repeat value="{!ld.commitments}" var="sub">
                        <Row>
                            <Cell ss:Index="3" ss:StyleID="s17">
                                <Data ss:Type="Number"><apex:outputText value="{!sub.quantity}" escape="false" /></Data>
                            </Cell>
                            <Cell ss:MergeAcross="3" ss:StyleID="s33">
                                <Data ss:Type="String"><apex:outputText value="{!sub.name}" escape="false" /></Data>
                            </Cell>
                            <Cell ss:StyleID="s18">
                                <Data ss:Type="String"><apex:outputText value="{!sub.tsf}" escape="false" /></Data>
                            </Cell>
                        </Row>
                    </apex:repeat>
                    <apex:repeat value="{!ld.oneTimeCharges}" var="sub">
                        <Row>
                            <Cell ss:Index="3" ss:StyleID="s17">
                                <Data ss:Type="Number"><apex:outputText value="{!sub.quantity}" escape="false" /></Data>
                            </Cell>
                            <Cell ss:MergeAcross="3" ss:StyleID="s33">
                                <Data ss:Type="String"><apex:outputText value="{!sub.name}" escape="false" /></Data>
                            </Cell>
                            <Cell ss:StyleID="s18">
                                <Data ss:Type="String"><apex:outputText value="{!sub.tsf}" escape="false" /></Data>
                            </Cell>
                        </Row>
                    </apex:repeat>
                </apex:repeat>
            </Table>
            <WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">
                <PageSetup>
                    <Header x:Margin="0.3" />
                    <Footer x:Margin="0.3" />
                    <PageMargins x:Bottom="0.75" x:Left="0.7" x:Right="0.7" x:Top="0.75" />
                </PageSetup>
                <Panes>
                    <Pane>
                        <Number>3</Number>
                        <ActiveRow>19</ActiveRow>
                        <ActiveCol>3</ActiveCol>
                    </Pane>
                </Panes>
                <ProtectObjects>False</ProtectObjects>
                <ProtectScenarios>False</ProtectScenarios>
            </WorksheetOptions>
        </Worksheet>
    </Workbook>
</apex:page>