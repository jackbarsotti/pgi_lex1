<?xml version="1.0" encoding="UTF-8"?>
<Workflow xmlns="http://soap.sforce.com/2006/04/metadata">
    <fieldUpdates>
        <fullName>FSL_Duration_On_Assign</fullName>
        <field>Duration</field>
        <formula>If(
    X10_10_Role__c
    &amp;&amp;
    Resource__r.Is_1010__c
,
    20
,
    If(
        ISBLANK(Duration)
        &amp;&amp;
        (
            Dynamic__c
            ||
            Work_Order__r.WorkType.Name = &quot;Break&quot;
        )

    ,
        15
    ,
        If(
            Dynamic__c
            ||
            Work_Order__r.WorkType.Name = &quot;Break&quot;
        ,
            Duration
        ,
            (DueDate - EarliestStartTime)*1440
        )
    )
)</formula>
        <name>FSL Duration On Assign</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Duration_Type</fullName>
        <field>DurationType</field>
        <literalValue>Minutes</literalValue>
        <name>FSL Duration Type</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Duration_Unassigned</fullName>
        <field>Duration</field>
        <formula>IF(
    !Dynamic__c
,    
    (DueDate - EarliestStartTime) * 1440
,
    IF(
        Dynamic__c
        &amp;&amp;
        (
            Duration = (DueDate - EarliestStartTime) * 1440
            ||
            ISBLANK(Duration)
        )
    ,
        15
    ,
        Duration
    )
)</formula>
        <name>FSL Duration Unassigned</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Fill_Igloo_Finish</fullName>
        <field>IGLOO_Finish__c</field>
        <formula>IF(
    ISBLANK(IGLOO_Finish__c)
,
    SchedEndTime
,
    IGLOO_Finish__c
)</formula>
        <name>FSL Fill Igloo Finish</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Fill_Igloo_Start</fullName>
        <field>IGLOO_Start__c</field>
        <formula>IF(
    ISBLANK(IGLOO_Start__c)
,
    SchedStartTime
,
    IGLOO_Start__c
)</formula>
        <name>FSL Fill Igloo Start</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Finish_Unnasigned</fullName>
        <field>SchedEndTime</field>
        <name>FSL Finish Unnasigned</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Null</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_IGLOO_Finish_to_ES</fullName>
        <field>DueDate</field>
        <formula>IF(
    !ISBLANK(IGLOO_Finish__c)
    ||
    (
        ISCHANGED(IGLOO_Finish__c)
        &amp;&amp;
        ISNEW()
    )

,
    IGLOO_Finish__c
,
    DueDate
)</formula>
        <name>FSL IGLOO Finish to ES</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_IGLOO_Start_to_ES</fullName>
        <field>EarliestStartTime</field>
        <formula>IF(
    !ISBLANK(IGLOO_Start__c)
    ||
    (
        ISCHANGED(IGLOO_Start__c)
        &amp;&amp;
        ISNEW()
    )

,
    IGLOO_Start__c
,
    EarliestStartTime
)</formula>
        <name>FSL IGLOO Start to ES</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Original_RoleId</fullName>
        <field>Original_RoleId__c</field>
        <formula>IF(
    ISBLANK(Original_RoleId__c)
,
    FSL__GanttLabel__c
,
    Original_RoleId__c
)</formula>
        <name>FSL Original RoleId</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Original_RoleId_Rollback</fullName>
        <field>Original_RoleId__c</field>
        <name>FSL Original RoleId Rollback</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Null</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_RoleID_RollBack</fullName>
        <field>Role_ID__c</field>
        <formula>IF(
    ISNEW()
,
    Role_ID__c
,
    Original_RoleId__c
)</formula>
        <name>FSL RoleID RollBack</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Role_Finish_on_Assign</fullName>
        <field>SchedEndTime</field>
        <formula>If(
    X10_10_Role__c
    &amp;&amp;
    Resource__r.Is_1010__c
,
    IGLOO_Finish__c - (5/1440)
,
    If(
        Dynamic__c
    ,
        SchedStartTime + (Duration / 1440)
    ,
        DueDate
    )
)</formula>
        <name>FSL Role Finish on Assign</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Role_Force_Dispatch</fullName>
        <field>Status</field>
        <literalValue>Dispatched</literalValue>
        <name>FSL Role Force Dispatch</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Role_Gantt_Label</fullName>
        <field>FSL__GanttLabel__c</field>
        <formula>Role_ID__c</formula>
        <name>FSL Role Gantt Label</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Role_ID_Status</fullName>
        <field>Role_ID__c</field>
        <formula>FSL__GanttLabel__c 
&amp; 
IF(
    TEXT(Status) = &quot;In Progress&quot;
,    
    &quot;_ip_&quot;
,
    IF(
        TEXT(Status) = &quot;Canceled&quot;
    ,    
        &quot;_ctx_&quot;
    ,
        IF(
            TEXT(Status) = &quot;Completed&quot;
        ,    
            &quot;_cmp_&quot;
        ,
            &quot;_&quot;
        )
    )
)
&amp; 
CASE(VALUE(LEFT(TEXT(NOW()), 4)) - 2015,1,&quot;a&quot;,2,&quot;b&quot;,3,&quot;c&quot;,4,&quot;d&quot;,5,&quot;e&quot;,6,&quot;f&quot;,7,&quot;g&quot;,8,&quot;h&quot;,9,&quot;i&quot;,10,&quot;j&quot;,11,&quot;k&quot;,12,&quot;l&quot;,&quot;*&quot;)
&amp;
CASE(VALUE(MID(TEXT(NOW()), 6, 2)),1,&quot;a&quot;,2,&quot;b&quot;,3,&quot;c&quot;,4,&quot;d&quot;,5,&quot;e&quot;,6,&quot;f&quot;,7,&quot;g&quot;,8,&quot;h&quot;,9,&quot;i&quot;,10,&quot;j&quot;,11,&quot;k&quot;,12,&quot;l&quot;,&quot;*&quot;)
&amp;
CASE(VALUE(MID(TEXT(NOW()), 9, 2)),1,&quot;aa&quot;,2,&quot;ab&quot;,3,&quot;ac&quot;,4,&quot;ad&quot;,5,&quot;ae&quot;,6,&quot;af&quot;,7,&quot;ag&quot;,8,&quot;ah&quot;,9,&quot;ai&quot;,10,&quot;aj&quot;,11,&quot;ak&quot;,12,&quot;al&quot;,13,&quot;am&quot;,14,&quot;an&quot;,15,&quot;ao&quot;,16,&quot;ap&quot;,17,&quot;aq&quot;,18,&quot;ar&quot;,19,&quot;as&quot;,20,&quot;at&quot;,21,&quot;au&quot;,22,&quot;av&quot;,23,&quot;aw&quot;,24,&quot;ax&quot;,25,&quot;ay&quot;,26,&quot;az&quot;,27,&quot;ba&quot;,28,&quot;bb&quot;,29,&quot;bc&quot;,30,&quot;bd&quot;,31,&quot;be&quot;,&quot;*&quot;)
&amp;
TEXT((VALUE(MID(TEXT(NOW()), 12, 2))*60)+(VALUE(MID(TEXT(NOW()), 15, 2))))</formula>
        <name>FSL Role ID Status</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Role_Start_on_Assign</fullName>
        <field>SchedStartTime</field>
        <formula>If(
    X10_10_Role__c
    &amp;&amp;
    Resource__r.Is_1010__c
,
    IGLOO_Start__c + (5/1440)
,
    If(
        Dynamic__c
        &amp;&amp;
        ISBLANK(SchedStartTime)
    ,
        EarliestStartTime
    ,
        If(
            Dynamic__c
        ,
            SchedStartTime
        ,
            EarliestStartTime
        )
    )
)</formula>
        <name>FSL Role Start on Assign</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>true</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Slide_DD_Restore</fullName>
        <field>DueDate</field>
        <formula>IF(
    Time_Slide__c
,
    IGLOO_Finish__c
,
    DueDate
)</formula>
        <name>FSL Slide DD Restore</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Slide_ES_Restore</fullName>
        <field>EarliestStartTime</field>
        <formula>IF(
    Time_Slide__c
,
    IGLOO_Start__c
,
    EarliestStartTime
)</formula>
        <name>FSL Slide ES Restore</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Start_Unnasigned</fullName>
        <field>SchedStartTime</field>
        <name>FSL Start Unnasigned</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Null</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Time_Slide_DD</fullName>
        <field>DueDate</field>
        <formula>IF(
    SchedEndTime &gt; DueDate
,
    SchedEndTime - (MOD(VALUE(MID(TEXT(SchedEndTime), 15, 2)),5)/1440)
,
    DueDate
)</formula>
        <name>FSL Time Slide DD</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Time_Slide_ES</fullName>
        <field>EarliestStartTime</field>
        <formula>IF(
    SchedStartTime &lt; EarliestStartTime
,
    SchedStartTime - (MOD(VALUE(MID(TEXT(SchedStartTime), 15, 2)),5)/1440)
,
    EarliestStartTime
)</formula>
        <name>FSL Time Slide ES</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Time_Slide_End</fullName>
        <field>SchedEndTime</field>
        <formula>SchedEndTime - (MOD(VALUE(MID(TEXT(SchedEndTime), 15, 2)),5)/1440)</formula>
        <name>FSL Time Slide End</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Time_Slide_Start</fullName>
        <field>SchedStartTime</field>
        <formula>SchedStartTime - (MOD(VALUE(MID(TEXT(SchedStartTime), 15, 2)),5)/1440)</formula>
        <name>FSL Time Slide Start</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Unassign</fullName>
        <field>Unassign__c</field>
        <literalValue>1</literalValue>
        <name>FSL Unassign</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>FSL_Update_Role_Assigned_Bridge</fullName>
        <field>Assigned_Bridge__c</field>
        <formula>IF(
    Is_Skilled__c
,
    Work_Order__r.Conference__r.Lead_Bridge__c
,
    Assigned_Bridge__c
)</formula>
        <name>FSL Update Role Assigned Bridge</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
    </fieldUpdates>
    <rules>
        <fullName>FSL Dispatch On Time</fullName>
        <active>true</active>
        <formula>!Time_Based_Reset__c  &amp;&amp; EarliestStartTime &gt; NOW() &amp;&amp; ISPICKVAL(Status, &quot;Scheduled&quot;)</formula>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
        <workflowTimeTriggers>
            <actions>
                <name>FSL_Role_Force_Dispatch</name>
                <type>FieldUpdate</type>
            </actions>
            <offsetFromField>ServiceAppointment.EarliestStartTime</offsetFromField>
            <timeLength>-8</timeLength>
            <workflowTimeTriggerUnit>Hours</workflowTimeTriggerUnit>
        </workflowTimeTriggers>
    </rules>
    <rules>
        <fullName>FSL Role Any Change</fullName>
        <actions>
            <name>FSL_Role_Gantt_Label</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_Update_Role_Assigned_Bridge</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <formula>ISNEW() || !NoFlow__c</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>FSL Role Changed to New</fullName>
        <actions>
            <name>FSL_Slide_DD_Restore</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_Slide_ES_Restore</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <formula>ISCHANGED(Status) &amp;&amp; ISPICKVAL(Status, &quot;New&quot;)</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>FSL Role IGLOO Updates</fullName>
        <actions>
            <name>FSL_IGLOO_Finish_to_ES</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_IGLOO_Start_to_ES</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <formula>ISNEW() || (     ISCHANGED(IGLOO_Start__c)     &amp;&amp;     !ISBLANK(IGLOO_Start__c) ) || (     ISCHANGED(IGLOO_Finish__c)     &amp;&amp;     !ISBLANK(IGLOO_Finish__c) )</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>FSL Role Slide</fullName>
        <actions>
            <name>FSL_Fill_Igloo_Finish</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_Fill_Igloo_Start</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_Time_Slide_DD</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_Time_Slide_ES</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_Time_Slide_End</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_Time_Slide_Start</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <formula>Time_Slide__c &amp;&amp; Is_Staffed__c &amp;&amp; (     ISCHANGED(SchedStartTime)     ||     ISCHANGED(SchedEndTime) )</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>FSL Role Unasigned</fullName>
        <actions>
            <name>FSL_Duration_Type</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_Duration_Unassigned</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_Finish_Unnasigned</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_Start_Unnasigned</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_Update_Role_Assigned_Bridge</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <formula>IsNew() || (     !Is_Staffed__c     &amp;&amp;     PRIORVALUE(Is_Staffed__c)     ||     (         !Time_Slide__c         &amp;&amp;         PRIORVALUE(EarliestStartTime) &gt;= EarliestStartTime         &amp;&amp;         PRIORVALUE(DueDate) &lt;= DueDate         &amp;&amp;         (             ISCHANGED(Dynamic__c)             ||             ISCHANGED(Duration)             ||             ISCHANGED(EarliestStartTime)             ||             ISCHANGED(DueDate)         )     ) ) || (     !ISBLANK(PRIORVALUE(Resource__c))     &amp;&amp;     ISBLANK(Resource__c) )</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>FSL Role on Assign</fullName>
        <actions>
            <name>FSL_Duration_On_Assign</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_Role_Finish_on_Assign</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_Role_Start_on_Assign</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <formula>(     Is_Staffed__c     &amp;&amp;     !Time_Slide__c     &amp;&amp;     (         ISCHANGED(Duration)         ||         ISCHANGED(EarliestStartTime)         ||         ISCHANGED(DueDate)         ||         ISCHANGED(SchedStartTime)         ||         ISCHANGED(SchedEndTime)         ||         ISCHANGED(Dynamic__c)     ) )     || (     ISCHANGED(Status)     &amp;&amp;     PRIORVALUE(Is_Staffed__c) = False     &amp;&amp;     Is_Staffed__c ) || (     ISBLANK(PRIORVALUE(Resource__c))     &amp;&amp;     !ISBLANK(Resource__c) )</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>FSL Status Changes</fullName>
        <actions>
            <name>FSL_Original_RoleId</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_Role_ID_Status</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <formula>ISCHANGED(Status) &amp;&amp; (     TEXT(Status) = &quot;Canceled&quot;     ||     (         TEXT(Status) = &quot;In Progress&quot;         &amp;&amp;         TEXT(PRIORVALUE(Status)) = &quot;Dispatched&quot;     )     ||     (         TEXT(Status) = &quot;Completed&quot;         &amp;&amp;         TEXT(PRIORVALUE(Status)) = &quot;In Progress&quot;     ) )</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>FSL Status IP Roleback</fullName>
        <actions>
            <name>FSL_Original_RoleId_Rollback</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>FSL_RoleID_RollBack</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <formula>ISNEW() || (     ISCHANGED(Status)     &amp;&amp;     ISPICKVAL(PRIORVALUE(Status), &quot;In Progress&quot;)     &amp;&amp;     !ISPICKVAL(Status , &quot;Completed&quot;)     &amp;&amp;     !ISPICKVAL(Status , &quot;Canceled&quot;)     &amp;&amp;     !ISPICKVAL(Status , &quot;Cannot Complete&quot;)      &amp;&amp;     CONTAINS(FSL__GanttLabel__c, &quot;_ip_&quot;)     &amp;&amp;     WorkType_Name__c &lt;&gt; &quot;Break&quot;     &amp;&amp;     !Dynamic__c )</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
</Workflow>
