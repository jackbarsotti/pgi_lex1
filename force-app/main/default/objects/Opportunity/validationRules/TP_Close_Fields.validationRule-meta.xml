<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>TP_Close_Fields</fullName>
    <active>true</active>
    <description>If an opportunity probability is 100 and the stage level is event/service completed, then require a mandatory field of product, solution and billing contact.</description>
    <errorConditionFormula>AND(
$User.Override_Validation_Rules__c = FALSE,
$User.ProfileId &lt;&gt; &quot;00e30000001kms9&quot;, 
 CONTAINS(RecordType.Name, &quot;TalkPoint&quot;),
 ISPICKVAL (StageName,&quot;Closed Won&quot;), 
 NOT(HasOpportunityLineItem)|| 
  ISBlank(TEXT(Solution__c))||
ISBLANK(  Contact__c )||
ISBLANK( Event_Date_if_different__c)||
ISBLANK ( PSR_ID__c ))</errorConditionFormula>
    <errorMessage>The following fields are required to close this opportunity: 
Billing Contact,
Event Date,
Is this a PGI Account,
Product Line Item (you must add a product),
PSR ID,
Solution</errorMessage>
</ValidationRule>
