<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>PGi_Existing_Svc_convsersion_downsell</fullName>
    <active>true</active>
    <description>Require an existing service when opportunity is conversion or downsell.</description>
    <errorConditionFormula>AND(
$User.ProfileId &lt;&gt; &quot;00e30000001kms9&quot;,
$User.ProfileId &lt;&gt; &quot;00ea0000001sYR8&quot;,
$User.ProfileId &lt;&gt; &quot;00ea0000001sdEo&quot;,
NOT($Setup.BypassRules__c.Disable_Validation_Rules__c),
 CONTAINS(RecordType.Name, &quot;PGi&quot;),
   NOT(ISPICKVAL(StageName, &quot;Awareness&quot;)),
  ISPICKVAL( Opportunity_Deal_Type__c, &quot;Down-Sell (Rev Decrease)&quot;) ||
ISPICKVAL( Opportunity_Deal_Type__c, &quot;Conversion&quot;),
 Count_of_Existing_Service__c &lt; 1)</errorConditionFormula>
    <errorDisplayField>StageName</errorDisplayField>
    <errorMessage>An Existing Product is required to move a Conversion or Down-Sell opportunity beyond the Awareness stage.</errorMessage>
</ValidationRule>
