<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>RFC_Task_Case_required_Resolution_Code</fullName>
    <active>false</active>
    <description>RFC Task Case requires resolution code and resolution comments when not closed successfully</description>
    <errorConditionFormula>OR(
AND(
RecordType.Name = &#39;PGi-Task Case&#39;,
NOT(ISPICKVAL( Resolution_Code__c , &quot;Successful&quot;)),
isBlank(Resolution_Comments__c)
),

AND(
RecordType.Name = &#39;PGi-Task Case&#39;,
IsClosed,
NOT(ISPICKVAL( Status, &quot;Closed - Not Needed&quot;)),
ISPICKVAL( Resolution_Code__c , &quot;&quot;)
))</errorConditionFormula>
    <errorDisplayField>Resolution_Code__c</errorDisplayField>
    <errorMessage>You must enter a Resolution Code. If the Resolution Code is not Successful, you must enter Resolution Comments as well.</errorMessage>
</ValidationRule>
